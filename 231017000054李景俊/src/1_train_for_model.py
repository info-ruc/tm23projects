import torch
from torch.utils.data import Dataset, DataLoader
from transformers import BertTokenizer, BertForSequenceClassification, AdamW

# 假设你有一个包含文本和标签的训练集
train_texts = [
    "项目管理良好，进度质量都正常",

    "工程项目管理注重信息化建设，采用先进的技术手段，提高项目管理的效率和精准度。",

    "项目经理具备团队领导能力，激发团队成员的潜力，确保项目团队的高效协同。",

    "工程管理层注重沟通技巧，与各利益相关方保持良好沟通，提高项目的透明度和合作度。",

    "项目管理层关注法规合规，确保项目在合法合规的基础上进行，降低法律风险。",

    "工程项目管理注重可行性研究，在项目初期进行详尽的可行性分析，降低项目失败的风险。",

    "项目经理关注员工健康和福祉，建立健康的工作氛围，提高员工的工作积极性。",

    "工程管理层注重利益平衡，确保各利益相关方在项目中能够获得公正的利益。",

    "项目管理强调项目目标的明确性，确保项目团队对项目目标的理解一致，提高项目的执行效果。",

    "工程项目管理注重创新，引入新技术和管理模式，推动工程领域的不断进步。",

    "项目经理善于风险管理，能够在项目中提前识别潜在风险，采取措施降低风险影响。",

    "工程管理层注重项目知识管理，总结项目经验，建立知识库，提高项目管理的水平。",

    "项目管理层注重可持续发展，在项目中采用环保和可再生资源，降低对环境的影响。",

    "工程项目管理强调质量培训，对项目团队进行质量管理方面的培训，提高团队的整体素质。",

    "项目经理具备决策能力，能够在复杂情况下迅速做出明智的决策，确保项目进展顺利。",

    "工程管理层注重项目文档管理，建立完善的文档体系，方便项目信息的追溯和管理。",

    "项目管理层注重与客户的沟通，了解客户需求，确保项目最终交付符合客户期望。",

    "工程项目管理关注社会责任，致力于为社会创造价值，推动可持续发展。",

    "项目管理层注重团队激励，采用激励机制激发团队成员的工作热情，提高工作效率。",

    "工程项目管理强调项目经验总结，及时总结项目中的经验教训，提高团队的学习能力。",

    "项目经理善于处理冲突，能够化解团队内部的矛盾，确保团队协同合作。",

    "工程管理层注重项目成本控制，合理分配资源，降低项目总成本，提高经济效益。",

    "项目管理层关注技术创新，引入新技术，提高项目的技术水平和竞争力。",

    "工程项目管理注重团队建设，培养和发展团队成员，确保团队的整体实力。",

    "项目经理具备沟通协调能力，能够有效协调项目各方利益，推动项目的平稳推进。",

    "工程管理层注重安全培训，建立健全的安全培训体系，确保施工现场的安全。",

    "项目管理层善于项目风险管理，制定有效的风险应对计划，保障项目的安全性。",

    "工程项目管理关注信息安全，采取措施保护项目信息，防范信息泄漏风险。",

    "项目经理善于团队建设，激发团队成员的潜能，提高团队整体的执行力。",

    "工程管理层注重项目评估，定期进行项目评估，发现并解决潜在问题，确保项目质量。",

    "项目管理层强调项目目标的可测性，确保项目目标可以量化，方便后期的评估和改进。",

    "工程项目管理注重合同管理，合理执行合同条款，确保项目合同的履行。",

    "项目经理关注项目推广，在项目成功完成后积极宣传，提高公司的知名度。",

    "工程管理层注重项目执行力，加强对项目实施过程的监督，提高项目的执行效果。",

    "项目管理层善于风险评估，能够提前识别潜在风险，采取有效措施防范风险。",

    "工程项目管理注重社会责任，关注项目对社会的影响，为社会创造积极价值。",

    "项目经理具备跨文化沟通能力，能够有效应对多元文化团队合作的挑战，确保项目成功。",

    "工程管理层注重项目协同管理，整合各方资源，提高项目的整体协同效应。",

    "项目管理层强调项目变更管理，及时应对项目变更，确保项目的稳定推进。",

    "工程项目管理注重团队培训，定期进行团队培训，提高团队成员的专业素养。",

    "项目经理关注项目创新，鼓励团队提出创新性建议，推动项目的不断创新。",

    "工程管理层注重项目合规性，确保项目在法律法规的框架内进行，降低法律风险。",

    "项目管理层强调项目信息保密，采取措施保护项目信息，防范信息泄漏风险。",

    "工程项目管理注重环境保护，采取措施降低项目对环境的影响，实现可持续发展。",

    "项目经理注重个人素养提升，不断学习和提高自身的综合素质，带领团队取得更好的成绩。",

    "工程管理层注重项目沟通管理，建立畅通的沟通渠道，确保信息能够及时传达。",

    "项目管理层关注项目目标的合理性，确保项目目标符合公司战略规划，推动公司发展。",

    "工程项目管理注重项目进度控制，建立详细的进度计划，确保项目按计划推进。",
    # ed 103-7=96 48
    "工程所在地可能受到自然灾害季节性影响，如台风季或雪季，可能对工程进度产生挑战。",

    "材料交付的错误可能导致重新订购和替代，对工程进度产生不利影响。",

    "环保组织的抗议可能导致工程现场的封锁或暂停，对进度形成严重的不确定性。",

    "施工人员的培训水平可能影响新技术的适应速度，需要额外的时间来确保团队的顺利运作。",

    "供应链中的运输问题，如罢工或交通拥堵，可能对物资的及时交付产生潜在威胁，影响工程进度。",

    "未经计划的工程检查和审查可能导致时间的不可预见延长，对进度产生潜在的不利影响。",

    "施工人员的工作时间限制，如法定工时，可能需要额外计划以确保工程计划的合理性。",
    
    "工程计划中未考虑到的变更可能导致工程人员需要额外的时间来重新安排工作流程，对进度产生潜在的压力。",

    "施工现场可能受到害虫或疾病的侵袭，需要额外的时间和资源来进行清理和防控，对进度产生不利影响。",

    "在设计阶段未能充分考虑现场实际情况可能导致施工人员需要花费更多时间来应对未预见的问题，对工程进度构成挑战。",

    "项目所在地的政治局势可能导致建筑许可的延迟，需要额外的时间来解决政治不稳定性带来的问题。",

    "施工材料的供应商财务不稳定可能导致交付延迟，对工程进度产生不确定性。",

    "技术设备的维修可能需要额外的时间，如果未能提前计划，可能对工程进度产生不利影响。",

    "施工现场的安全检查可能需要更多的时间，特别是在使用新设备或工艺时，对进度构成额外压力。",

    "施工过程中的变更请求可能需要额外的审批时间，如果未能及时处理，可能对工程进度造成延误。",
    
    "施工现场可能受到盗窃或破坏行为的威胁，需要加强安全措施以防止这些事件对工程进度的负面影响。",

    "政府批准和许可的延误可能导致施工计划的不稳定，需要额外的时间来解决审批问题。",

    "施工现场可能受到自然灾害的影响，如地震、洪水或飓风，可能导致工程暂时停工，对进度产生不利影响。",

    "供应链中关键材料的质量问题可能导致重新采购和替代，对工程进度产生额外的不确定性。",

    "合同纠纷可能导致工程进度的不确定性，需要额外的法律程序来解决争端。",

    "施工人员的工会问题可能导致罢工或工作中断，对工程进度造成潜在困扰。",

    "新技术的迅速发展可能导致现有施工方法的过时，需要额外的时间来培训团队适应新技术。",

    "环保法规的变更可能导致额外的审查和调整，对工程进度产生不利影响。",
    
    "新型工程设备的采购可能会受到市场供应不足的影响，从而对工程进度造成潜在困扰。",

    "项目变更可能需要额外的审批和文件工作，导致计划调整，对进度产生不利影响。",

    "施工现场的土壤条件可能与预期不符，可能需要重新评估基础设计，对工程进度产生延误。",

    "全球性的大流行病（如疫情）可能导致劳工不足、物资供应不稳定，进而影响工程进度。",

    "施工队伍的培训水平不足可能导致施工过程中出现错误，增加修改和重新工作的需求，对进度产生负面影响。",

    "现场安全事故可能导致工程现场暂时关闭，需要额外时间来进行调查和修复，对进度形成打击。",

    "与政府审批相关的纠纷或延误可能导致施工计划的不确定性，对工程进度构成潜在风险。",

    "项目资金不足可能导致工程暂时停工，直至财务问题解决，对进度产生显著的不利影响。",
    
    "工程中可能发生的法律诉讼或索赔可能导致施工进度受到不确定性影响，需要额外的法律程序和调整。",

    "施工人员培训计划的不足可能导致新技术的引入变得更加复杂，对工程进度产生额外压力。",

    "项目变更管理不善可能导致施工团队对新计划的不适应，从而对工程进度形成阻碍。",

    "工程现场的交通规划不当可能导致物资运输的不顺畅，增加工程进度的不确定性。",

    "施工现场可能受到盗窃或破坏行为的威胁，需要加强安全措施以防止这些事件对工程进度的负面影响。",

    "环境监测和合规审查可能对施工计划产生额外的限制，需要谨慎规划以确保符合法规。",

    "供应链的全球性不稳定性，如国际运输问题或政治事件，可能导致工程进度面临更大的不确定性。",

    "施工过程中可能遇到的技术难题可能需要更多时间来解决，对进度造成潜在的挑战。",
    
    "施工过程中可能出现的设备故障，有可能导致维修时间延误，从而对工程进度产生负面影响。",

    "材料供应商的破产或交货延迟可能使施工计划面临不可预见的挑战，影响整体进度。",

    "工程所在地的政治不稳定可能导致建筑许可延迟，对工程进度形成潜在威胁。",

    "工程现场可能面临的安全检查和合规性审查可能导致额外的时间投入，对进度构成潜在影响。",

    "施工现场可能遭遇突发事件，如火灾或爆炸，可能导致工程停工，对进度造成严重打击。",

    "人力资源短缺或施工队伍的高员工流动率可能对工程进度产生挑战，需要谨慎的人力规划。",

    "项目中使用的新技术，如BIM或虚拟现实，可能需要额外的时间来培训施工团队，影响工程进度。",
    
    "施工现场交通拥堵可能导致物资运输延误，进而影响整体工程进度。",

    "设计图纸中的模糊不清细节可能要求施工人员额外花费时间来解决问题，从而影响工程进度。",

    "特殊材料供应受市场波动影响，交付时间不确定，可能对工程进度产生负面影响。",

    "恶劣天气条件，如极端温度或持续降雨，可能导致工程进度的不稳定性。",

    "合同或客户需求变更可能要求重新调整工程计划，从而影响原定的进度安排。",

    "施工团队关键人员因健康或其他不可预见原因暂时离开，可能对工程进度造成挑战。",

    "未知地下设施或地质条件的发现可能需要调整工程计划，对进度产生不利影响。",
    # 209-103=106 53条
    "施工过程中未按照建筑规范和标准进行适当的质量控制可能导致工程质量不达标，对整体施工质量带来潜在威胁。",

    "施工现场未建立严格的材料追溯体系和质量档案管理制度可能使得质量问题难以溯源和纠正，对工程整体质量构成潜在危害。",

    "建筑结构设计存在漏洞和不足可能导致工程施工阶段出现结构性质量问题，对整体施工质量带来潜在威胁。",

    "施工过程中未对建筑材料进行适当的储存和保护可能导致材料损坏或污染，对工程整体质量带来潜在危害。",

    "施工人员未经过充分的施工工艺培训和技能考核可能导致施工工艺不规范，对整体施工质量带来潜在威胁。",

    "工程施工过程中未对施工现场环境进行合理管理可能导致施工质量受到外部因素的干扰，对整体质量构成潜在危害。",

    "施工现场缺少适当的质量问题反馈和整改机制可能导致质量问题无法及时纠正，对工程整体质量带来潜在威胁。",

    "施工过程中未进行适当的工程验收和整体质量评估可能导致质量问题未能及时发现和解决，对整体施工质量构成潜在危害。",

    "施工现场未建立明确的施工工程质量验收标准和流程可能导致施工质量评估不准确，对整体质量带来潜在威胁。",

    "工程施工过程中未严格执行质量控制计划和程序可能导致施工过程中质量问题逐渐积累，对整体质量带来潜在危害。",

    "施工现场未建立有效的质量安全教育体系和培训计划可能使得施工人员对质量问题的认识不足，对整体质量构成潜在威胁。",

    "施工过程中未按照工程质量验收标准进行适当的验收可能导致工程质量不符合规范要求，对整体施工质量带来潜在威胁。",

    "建筑工程施工现场未建立明确的工程质量管理责任体系可能导致质量问题的责任不明确，对整体质量构成潜在危害。",

    "施工过程中未按照工程质量计划进行适当的质量控制和检查可能导致质量问题未能及时发现和处理，对整体施工质量带来潜在威胁。",

    "建筑工程施工现场未建立明确的质量检测和监测机制可能导致工程施工过程中的质量问题无法及时察觉，对整体质量构成潜在危害。",

    "施工现场未制定适当的施工工艺流程和操作规范可能导致施工工艺不合理，对整体施工质量带来潜在威胁。",

    "施工过程中未进行适当的建筑结构安全评估和质量检测可能导致结构性质量问题，对整体施工质量带来潜在危害。",

    "工程现场未建立质量问题的记录和统计体系可能导致质量问题的趋势无法及时分析，对整体质量构成潜在危害。",

    "施工现场未建立适当的施工工程质量管理团队和质量技术支持体系可能导致质量问题未能及时得到专业解决，对整体施工质量带来潜在威胁。",

    "建筑工程施工现场未建立明确的质量反馈和改进机制可能导致质量问题反馈不及时，对整体质量构成潜在危害。",

    "施工过程中未进行适当的施工工程技术培训和质量管理培训可能导致施工人员技术水平下降，对整体施工质量带来潜在威胁。",

    "工程现场未建立有效的质量问题应急处置计划和预案可能导致质量问题发生时无法迅速应对，对整体质量构成潜在危害。",

    "施工过程中未对关键工序和关键节点进行重点质量监测可能导致质量问题未能及时发现，对整体施工质量带来潜在威胁。",

    "建筑工程施工现场未建立明确的质量问题追溯和责任追究机制可能导致质量问题发生后责任不明晰，对整体质量构成潜在危害。",

    "施工过程中未建立适当的施工工程质量文件管理体系可能导致质量问题的资料不完整，对整体施工质量带来潜在威胁。",

    "工程现场未建立适当的质量问题定期分析和总结机制可能导致质量问题的原因无法得到深入分析，对整体质量构成潜在危害。",
    # 261-209=52 26
    "现场电气设备未按规定维护可能引发电气火灾，对工程现场安全构成潜在威胁。",

    "缺乏定期进行的紧急演练和模拟事故培训可能导致工人在紧急情况下无法有效应对，延误救援行动，对施工安全带来潜在危害。",

    "施工设备操作人员未按照规定的安全程序操作可能导致事故，对工程安全带来潜在不利影响。",

    "未建立适当的气象监测系统可能在极端天气条件下未能及时预警，对工程安全带来潜在风险。",

    "施工现场未进行适当的危险物品分类和储存可能导致物品混乱，增加危险品事故的概率，对施工安全带来潜在威胁。",

    "工程现场未按规定进行的紧急停工程序可能导致突发状况处理不当，对工程安全带来潜在不利影响。",

    "未建立明确的施工现场进出管理制度可能导致非授权人员进入，增加事故风险，对施工安全构成潜在威胁。",

    "缺乏有效的安全监控系统和定期的安全审查可能导致潜在危险未被及时发现和处理，增加工程现场事故风险，对工程带来不利影响。",

    "施工人员未按规定使用个人防护装备可能导致受伤事故，需要额外时间来处理伤害，对工程带来潜在的延误。",

    "施工现场缺乏足够的紧急疏散路线和出口标识可能在紧急情况下造成混乱，延误工人疏散，对工程安全带来潜在威胁。",

    "工人未经过定期的健康检查可能导致潜在的健康问题，需要额外的时间来处理健康问题，对工程带来潜在的延误。",
    
    "施工现场未建立有效的通风系统和废气排放措施可能导致工人暴露于有害气体中，对工人健康带来潜在威胁。",
    
    "缺乏定期进行的施工设备安全检查和维护可能导致设备故障，增加工人受伤风险，对工程安全带来潜在危害。",
    
    "施工工地周边环境缺乏足够的安全隔离措施可能导致外部人员误入施工区域，对工程安全带来潜在风险。",
    
    "施工现场未按规定安装紧急停工按钮可能导致紧急情况下难以及时终止工程，对工程安全带来潜在不利影响。",

    "工地未建立足够的紧急应变团队和装备库可能在事故发生时降低救援效率，对施工安全带来潜在的危害。",

    "施工工地未实施定期的安全文明施工培训可能导致工人行为不当，增加工地事故风险，对工程带来潜在威胁。",
    
    "缺乏合适的危险品存放区域和相关安全标识可能导致危险品事故的概率增加，对施工安全构成潜在威胁。",

    "工程现场未建立明确的高风险作业审批程序可能导致高风险工作未经适当审批，增加工人受伤风险，对工程安全带来潜在危害。",

    "施工现场缺乏适当的紧急疏散演练和定期的安全演练可能导致工人在紧急情况下无法迅速响应，对施工安全带来潜在风险。",
    
    "现场缺少专业的安全管理人员和安全培训师资资源可能导致安全问题未能得到及时处理，增加工程现场事故风险，对工程带来不利影响。",
    
    "施工现场未建立明确的施工工程负责人和安全监管责任体系可能导致管理混乱，增加工程现场事故风险，对工程带来潜在危害。",

    "施工设备未按规定操作和维护可能导致设备故障，增加工人受伤风险，对工程安全带来潜在危害。",

    "现场未设立专门的危险区域警示系统和安全巡逻制度可能导致工人进入高风险区域，增加事故风险，对工程安全带来潜在风险。",
    
    "施工现场未建立有效的紧急通讯系统和工人报警流程可能导致在紧急情况下信息传递不畅，延误紧急响应，对施工安全带来潜在威胁。",

    "缺乏明确的安全责任分工和安全管理团队可能导致安全问题未能得到及时处理，增加工程现场事故风险，对工程带来不利影响。",

    "施工现场未实施定期的安全培训和意外事故演练可能使工人在紧急情况下不知所措，延误紧急救援，对施工安全带来潜在风险。",

    "工程现场未建立适当的物料储存和处理措施可能导致危险品泄漏或爆炸，对施工安全构成潜在的双重威胁。",

    "缺少现场巡检和定期维护可能使安全设施失效，增加工人受伤的可能性，对工程安全带来潜在危害。",

    "施工现场未设置明确的交通导向和指示标识可能导致交通混乱，增加机械设备事故风险，对施工带来潜在危害。",
    # 321-261=60 30条
    "工程管理得当，现场质量有力可循。",

    "良好的工程管理确保了现场质量的可靠表现。",

    "出色的工程管理保障了现场质量的高水平维护。",

    "工程管理体系良好，现场质量可圈可点。",

    "得心应手的工程管理助力现场质量的出色表现。",

    "卓越的工程管理确保了现场质量的可靠性。",

    "工程管理层面出色，现场质量表现优秀。",

    "现场质量得益于卓越的工程管理实践。",

    "工程管理有方，现场质量可圈可点。",

    "出色的工程管理确保了现场质量的卓越表现。",

    "工程管理层面出众，现场质量可圈可点。",

    "得心应手的工程管理确保了现场质量的可靠性。",

    "工程管理得当，现场质量表现令人满意。",

    "出色的工程管理为现场质量的提升奠定了基础。",

    "工程管理出色，现场质量得到了有效维护。",

    "卓越的工程管理实践确保了现场质量的出色表现。",

    "工程管理得当，现场质量层层把关。",

    "工程管理有方，现场质量表现亮眼。",

    "工程管理水平高，现场质量可圈可点。",

    "工程管理得当，现场质量层层把关。",

    "得心应手的工程管理实践确保了现场质量的稳定表现。",

    "工程管理层面高超，现场质量得到了可靠维护。",

    "工程管理有方，现场质量表现优越。",

    "工程管理得当，现场质量表现稳健可靠。",

    "卓越的工程管理实践确保了现场质量的卓越表现。",

    "工程管理水平高，现场质量层层把关。",

    "工程管理得当，现场质量得以有效掌控。",

    "出色的工程管理为现场质量的提升奠定了基础。",

    "工程管理水平高，现场质量表现出色。",

    "工程管理得当，现场质量可圈可点。",

    "工程管理层面出色，现场质量表现优秀。",

    "得心应手的工程管理确保了现场质量的可靠性。",

    "工程管理水平高，现场质量得到了可靠维护。",

    "工程管理有方，现场质量表现亮眼。",

    "工程管理得当，现场质量层层把关。",

    "工程管理实践卓越，现场质量得以稳定维护。",

    "工程管理水平高，现场质量得到了可靠维护。",

    "工程管理得当，现场质量表现令人满意。",

    "出色的工程管理为现场质量的提升奠定了基础。",

    "工程管理得当，现场质量层层把关。",

    "工程管理有方，现场质量表现亮眼。",

    "工程管理水平高，现场质量得到了可靠维护。",

    "工程管理得当，现场质量表现稳健可靠。",

    "卓越的工程管理实践确保了现场质量的卓越表现。",

    "工程管理水平高，现场质量层层把关。",

    "工程管理得当，现场质量得以有效掌控。",

    "工程管理层面出色，现场质量表现优秀。",

    "得心应手的工程管理确保了现场质量的可靠性。",

    "工程管理水平高，现场质量得到了可靠维护。",

    "工程管理有方，现场质量表现亮眼。",

    "工程管理得当，现场质量层层把关。",

    "工程管理实践卓越，现场质量得以稳定维护。",

    "工程管理水平高，现场质量得到了可靠维护。",
    # 334-228=106 53
    # ... （重复上述模式，总计200条）调整。"


]

train_labels = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1,
                1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
                1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
                1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
                1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
                1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                0, 0, 0, 0, 0, 0, 0, 0, 0,  0,]

# 数据预处理，创建数据集
# 数据预处理，创建数据集
class RiskDataset(Dataset):
    def __init__(self, texts, labels):
        self.texts = texts
        self.labels = labels
        self.tokenizer = BertTokenizer.from_pretrained('bert-base-uncased')

    def __len__(self):
        return len(self.texts)

    def __getitem__(self, idx):
        text = self.texts[idx]
        label = self.labels[idx]
        encoding = self.tokenizer(text, return_tensors='pt', padding=True, truncation=True, max_length=128)
        return {
            'input_ids': encoding['input_ids'].flatten(),
            'attention_mask': encoding['attention_mask'].flatten(),
            'label': torch.tensor(label)
        }


# 创建数据集和数据加载器
train_dataset = RiskDataset(train_texts, train_labels)
train_loader = DataLoader(train_dataset, batch_size=1, shuffle=True)

# 模型搭建
model = BertForSequenceClassification.from_pretrained('bert-base-uncased', num_labels=2)
criterion = torch.nn.CrossEntropyLoss()
optimizer = AdamW(model.parameters(), lr=5e-5)

# 训练模型
device = torch.device('cuda' if torch.cuda.is_available() else 'cpu')
model.to(device)
model.train()

# 为了简化示例，假设有3个epoch，实际中可能需要更多
for epoch in range(5):
    # 遍历数据加载器进行训练
    for batch in train_loader:
        input_ids = batch['input_ids'].to(device)
        attention_mask = batch['attention_mask'].to(device)
        labels = batch['label'].to(device)

        # 梯度清零
        optimizer.zero_grad()
        # 前向传播，计算损失
        outputs = model(input_ids, attention_mask=attention_mask)
        loss = criterion(outputs.logits, labels)
        # 反向传播，更新参数
        loss.backward()
        optimizer.step()

# 训练结束后，你可以保存模型
model.save_pretrained('path/to/save/model')