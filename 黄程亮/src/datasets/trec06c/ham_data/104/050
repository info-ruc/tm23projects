Received: from smtp-2.llnl.gov ([128.115.250.82] verified)
  by mailbe-2.llnl.gov (CommuniGate Pro SMTP 4.1.8)
  with ESMTP id 25791052 for orvis1@mail.llnl.gov; Fri, 15 Jul 2005 08:50:30
- -0700
Received: from ciac.org (ciac.org [198.128.39.4])
	by smtp-2.llnl.gov (8.12.3p2-20030917/8.12.3/LLNL evision: 1.15 $) with ESMTP
id j6FFoMU7014881
	for <orvis@llnl.gov>; Fri, 15 Jul 2005 08:50:23 -0700 (PDT)
Received: from hotmail.com (bay15-f23.bay15.hotmail.com [65.54.185.23])
	by ciac.org (8.11.7p1+Sun/8.11.6/LLNL-6.2) with ESMTP id j6FFmor27196
	for <hoaxmaster@ciac.org>; Fri, 15 Jul 2005 08:48:50 -0700 (PDT)
Received: from mail pickup service by hotmail.com with Microsoft SMTPSVC;
	 Fri, 15 Jul 2005 08:49:22 -0700
Message-ID: <BAY15-F23D89D1616F8ED740CE0268CD00@phx.gbl>
Received: from 196.3.60.17 by by15fd.bay15.hotmail.msn.com with HTTP;
	Fri, 15 Jul 2005 15:49:22 GMT
X-Originating-IP: [196.3.60.17]
X-Originating-Email: [musasike4@devbankofsouthafrica.com]
X-Sender: musasike4@devbankofsouthafrica.com
Reply-To: lmusasike10@excite.com
From: "lewis musasike" <musasike4@devbankofsouthafrica.com>
To: musasike4@devbankofsouthafrica.com
Subject: HELLO
Date: Fri, 15 Jul 2005 15:49:22 +0000
Mime-Version: 1.0
Content-Type: text/plain; format=flowed
X-OriginalArrivalTime: 15 Jul 2005 15:49:23.0012 (UTC)
FILETIME=[C5499840:01C58954]
X-Scanned-By: MIMEDefang 2.39

Hello,

I am Mr Lewis Musasike, General Manager(Treasury) of Development Bank of 
Southern Africa.This is an urgent and very confidential business 
proposition.

Note that everything below the line marked, X-Originating-IP: can be faked. An
intruder could also fake some of the Received: from headers but then they would
not match.

The Received: from headers start just above the line marked, X-Originating-IP:.
As an e-mail message passes from mailer to mailer on its way from the sender to
the receiver, each mailer adds a Received: from header to the top of the
message. Thus, the Received: from headers build up from the top of the message
as the mail moves from mailer to mailer.

Look at the first Received: from header just above the line marked,
X-Originating-IP:

Received: from 196.3.60.17 by by15fd.bay15.hotmail.msn.com with HTTP;
	Fri, 15 Jul 2005 15:49:22 GMT

This being the first Received: from header, the address received from is the
original sender of the message. Here, that is 196.3.60.17. As this IP address
is not one of our local IP addresses, I can be sure that this message was not
sent by my manager or anyone from my company.

Looking at another header,

Received: from hotmail.com (bay15-f23.bay15.hotmail.com [65.54.185.23])
	by ciac.org (8.11.7p1+Sun/8.11.6/LLNL-6.2) 
	with ESMTP id j6FFmor27196
	for <hoaxmaster@ciac.org>; Fri, 15 Jul 2005 08:48:50 -0700 (PDT)

This one has a little different format. Here the name hotmail.com is what the
previous mailer told the mailer that is adding the header what its name is.
Many worms and viruses fake this value. However, the next part,

(bay15-f23.bay15.hotmail.com [65.54.185.23])

is created by the mailer adding the header and cannot be faked so always use
the values in parenthesis to tell you who the message was received from.

Note that while it is possible to stick fake Received: from headers on the top
of a message before sending it, the fake headers will likely result in a
discontinuity in the path a message takes or in the dates and times the message
is passed. 

Requesting Verification
=======================

Another option is to reply to the message without reading the attachment,
asking the sender if he or she really sent it. This is relatively easy to do
but requires you to wait for the sender’s reply before opening the attachment.
When sending the reply, make sure the message is going to the correct person.

Message Signing
===============

The best way to verify a message is with cryptographic message signing but to
do so requires a company wide infrastructure to be in place before it can work.
Programs such as PGP and Entrust provide a message signing capability. The way
message signing works is that a cryptographic checksum of the message is
calculated using the sender’s secret key. The receiver decrypts that checksum
using the sender’s public key. If the secret and public keys are not a
legitimate key pair or if the message is changed in any way, the cryptographic
checksum fails and you cannot trust the sender or content of the message. 

The cryptographic checksum is sufficiently difficult to calculate without
knowing the private key that it is nearly impossible to change a signed message
and have the signature still be valid.

To make this work, the sender must have created a public and private key pair
and have previously sent the public key to the receiver in a manner such that
the receiver is sure that the public key really does belong to the sender. How
you do that depends on which program you use to manage your keys. Entrust has a
site wide infrastructure that securely communicates the keys from person to
person in the background. With PGP you must manually send the key to the
receiver or make it available on a trustworthy key server.

Conclusions
===========

Targeted attacks against our systems are increasing and are difficult to detect
because they do not trigger antivirus or spyware detectors. This does not mean
that you should not keep your antivirus and spyware detectors up to date as
they are still effective against a large class of malicious code. Currently,
the way to detect attack messages is to authenticate the sender of the message
to make sure he really sent the message and attachment. You can do so by
checking the e-mail headers, validating the message with the sender, or by
using cryptographic signatures. Using cryptographic signatures is the easiest
and most accurate solution for the general user after the public key
infrastructure is in place.



CIAC, the Computer Incident Advisory Capability, is the computer
security incident response team for the U.S. Department of Energy
(DOE) and the emergency backup response team for the National
Institutes of Health (NIH). CIAC is located at the Lawrence Livermore
National Laboratory in Livermore, California. CIAC is also a founding
member of FIRST, the Forum of Incident Response and Security Teams, a
global organization established to foster cooperation and coordination
among computer security teams worldwide.

CIAC services are available to DOE, DOE contractors, and the NIH. CIAC
can be contacted at:
    Voice:    +1 925-422-8193 (7x24)
    FAX:      +1 925-423-8002
    STU-III:  +1 925-423-2604
    E-mail:   ciac@ciac.org

Previous CIAC notices, anti-virus software, and other information are
available from the CIAC Computer Security Archive.

   World Wide Web:      http://www.ciac.org/
   Anonymous FTP:       ftp.ciac.org

PLEASE NOTE: Many users outside of the DOE, ESnet, and NIH computing
communities receive CIAC bulletins.  If you are not part of these
communities, please contact your agency's response team to report
incidents. Your agency's team will coordinate with CIAC. The Forum of
Incident Response and Security Teams (FIRST) is a world-wide
organization. A list of FIRST member organizations and their
constituencies can be obtained via WWW at http://www.first.org/.

This document was prepared as an account of work sponsored by an
agency of the United States Government. Neither the United States
Government nor the University of California nor any of their
employees, makes any warranty, express or implied, or assumes any
legal liability or responsibility for the accuracy, completeness, or
usefulness of any information, apparatus, product, or process
disclosed, or represents that its use would not infringe privately
owned rights. Reference herein to any specific commercial products,
process, or service by trade name, trademark, manufacturer, or
otherwise, does not necessarily constitute or imply its endorsement,
recommendation or favoring by the United States Government or the
University of California. The views and opinions of authors expressed
herein do not necessarily state or reflect those of the United States
Government or the University of California, and shall not be used for
advertising or product endorsement purposes.

LAST 10 CIAC BULLETINS ISSUED (Previous bulletins available from CIAC)

P-246: Microsoft Word Font Parsing Vulnerability
P-247: Microsoft Vulnerability in JView Profiler
P-248: Microsoft Color Management Module Vulnerability
P-249: krb5 Security Update
P-250: Critical Patch Update - July 2005
P-251: Mozilla Security Updates
P-252: Firefox Security Updates
P-253: Solaris Runtime Linker Vulnerability
P-254: 'tiff' Buffer Overflow Vulnerability
P-255: Heimdal

-----BEGIN PGP SIGNATURE-----
Version: PGP 8.1

iQCVAwUBQtw3hbnzJzdsy3QZAQF0sQP+I8YL0eMaBr67YymOpkMAFjtLr8WoQxIT
kBSzLn7iEqtT6SUTdMNmQuKvLWSDil9mBOf3pXWULG1VhuLvatutEvCUPXz4Nau8
/WHDxGiUvFgv/9l7anjQLNTXuaJR9+avhN/c1NbWiTQzEUMuEo9b/UhnXwtfPPzu
l0mW6K5M5FM=
=Y0nq
-----END PGP SIGNATURE-----
